/*
* Kendo UI v2015.1.430 (http://www.telerik.com/kendo-ui)
* Copyright 2015 Telerik AD. All rights reserved.
*
* Kendo UI commercial licenses may be obtained at
* http://www.telerik.com/purchase/license-agreement/kendo-ui-complete
* If you do not own a commercial license, this file shall be governed by the trial license terms.
*/
!function(e,define){define(["./kendo.dom.min","./kendo.data.min","./kendo.columnsorter.min","./kendo.editable.min","./kendo.window.min","./kendo.filtermenu.min","./kendo.selectable.min","./kendo.resizable.min"],e)}(function(){return function(e,t){function n(e){return function(t){return t[e]}}function i(e){return function(t){return!e(t)}}function r(e){var t,n,i=[],r=e.className;for(t=0,n=e.level;n>t;t++)i.push(h("span",{className:r}));return i}function o(e){var t,n,i,r=0;for(n=0,i=e.length;i>n;n++)t=e[n].style.width,t&&-1==t.indexOf("%")&&(r+=parseInt(t,10));return r}var a,s,l,c=kendo.data,d=e.extend,u=kendo.dom,h=u.element,f=u.text,p=u.html,g=kendo.ui,m=g.DataBoundWidget,v=c.DataSource,_=c.ObservableArray,y=c.Query,w=c.Model,b=e.proxy,x=e.map,k=e.grep,S=e.inArray,C=e.isPlainObject,T=Array.prototype.push,A="string",D="change",M="error",E="progress",P=".",z=".kendoTreeList",I="click",B="mousedown",L="edit",R="save",F="expand",O="collapse",N="remove",H="dataBinding",V="dataBound",U="cancel",W="filterMenuInit",j="columnHide",G="columnShow",q="th.k-header",$="columnReorder",Y="columnResize",K="columnMenuInit",Q="columnLock",X="columnUnlock",J={wrapper:"k-treelist k-grid k-widget",header:"k-header",button:"k-button",alt:"k-alt",editCell:"k-edit-cell",group:"k-treelist-group",gridToolbar:"k-grid-toolbar",gridHeader:"k-grid-header",gridHeaderWrap:"k-grid-header-wrap",gridContent:"k-grid-content",gridContentWrap:"k-grid-content",gridFilter:"k-grid-filter",footerTemplate:"k-footer-template",loading:"k-loading",refresh:"k-i-refresh",retry:"k-request-retry",selected:"k-state-selected",status:"k-status",link:"k-link",withIcon:"k-with-icon",filterable:"k-filterable",icon:"k-icon",iconFilter:"k-filter",iconCollapse:"k-i-collapse",iconExpand:"k-i-expand",iconHidden:"k-i-none",iconPlaceHolder:"k-icon k-i-none",input:"k-input",dropPositions:"k-insert-top k-insert-bottom k-add k-insert-middle",dropTop:"k-insert-top",dropBottom:"k-insert-bottom",dropAdd:"k-add",dropMiddle:"k-insert-middle",dropDenied:"k-denied",dragStatus:"k-drag-status",dragClue:"k-drag-clue",dragClueText:"k-clue-text"},Z={create:{imageClass:"k-add",className:"k-grid-add",methodName:"addRow"},createchild:{imageClass:"k-add",className:"k-grid-add",methodName:"addRow"},destroy:{imageClass:"k-delete",className:"k-grid-delete",methodName:"removeRow"},edit:{imageClass:"k-edit",className:"k-grid-edit",methodName:"editRow"},update:{imageClass:"k-update",className:"k-primary k-grid-update",methodName:"saveRow"},canceledit:{imageClass:"k-cancel",className:"k-grid-cancel",methodName:"_cancelEdit"},excel:{imageClass:"k-i-excel",className:"k-grid-excel",methodName:"saveAsExcel"},pdf:{imageClass:"k-i-pdf",className:"k-grid-pdf",methodName:"saveAsPDF"}},et=w.define({id:"id",fields:{id:{type:"number"},parentId:{type:"number",nullable:!0}},init:function(e){w.fn.init.call(this,e),this._loaded=!1},loaded:function(e){return e===t?this._loaded:(this._loaded=e,t)},shouldSerialize:function(e){return w.fn.shouldSerialize.call(this,e)&&"_loaded"!==e&&"_error"!=e&&"_edit"!=e}}),tt=v.extend({init:function(e){v.fn.init.call(this,d(!0,{},{schema:{modelBase:et,model:et}},e))},_createNewModel:function(e){var t={},n=e instanceof w;return n&&(t=e),t=v.fn._createNewModel.call(this,t),n||t.accept(e),t},_readData:function(e){var t,n,i=[],r=this.data();for(t=0,n=r.length;n>t;t++)i.push(r[t]);return i.concat(v.fn._readData.call(this,e))},_readAggregates:function(e){var t=d(this._aggregateResult,this.reader.aggregates(e));return""in t&&(t[this._defaultParentId()]=t[""],delete t[""]),t},remove:function(e){var t=this._subtree(this._childrenMap(this.data()),e.id);this._removeItems(t),v.fn.remove.call(this,e)},_filterCallback:function(e){var t,n,i=[],r=e.toArray(),o={};for(t=0;r.length>t;t++)for(n=r[t];n&&(o[n.id]=!0,!o[n.parentId]);)o[n.parentId]=!0,n=this.parentNode(n),n&&i.push(n);return new y(r.concat(i))},_subtree:function(e,t){var n,i,r=e[t]||[],o=this._defaultParentId();for(n=0,i=r.length;i>n;n++)r[n].id!==o&&(r=r.concat(this._subtree(e,r[n].id)));return r},_childrenMap:function(e){var t,n,i,r,o={};for(e=this._observeView(e),t=0;e.length>t;t++)n=e[t],i=n.id,r=n.parentId,o[i]=o[i]||[],o[r]=o[r]||[],o[r].push(n);return o},_calculateAggregates:function(e,t){var n,i,r,o,a,s;for(t=t||{},n={},a=t.filter,a&&(e=y.process(e,{filter:a,filterCallback:b(this._filterCallback,this)}).data),s=this._childrenMap(e),n[this._defaultParentId()]=new y(this._subtree(s,this._defaultParentId())).aggregate(t.aggregate),o=0;e.length>o;o++)i=e[o],r=this._subtree(s,i.id),n[i.id]=new y(r).aggregate(t.aggregate);return n},_queryProcess:function(e,t){var n,i,r,o,a,s,l;for(t=t||{},t.filterCallback=b(this._filterCallback,this),n=this._defaultParentId(),i=y.process(e,t),r=this._childrenMap(i.data),e=r[n]||[],a=0;e.length>a;a++)s=e[a],s.id!==n&&(l=r[s.id],o=!(!l||!l.length),s.loaded()||s.loaded(o||!s.hasChildren),(s.loaded()||s.hasChildren!==!0)&&(s.hasChildren=o),o&&e.splice.apply(e,[a+1,0].concat(l)));return i.data=e,i},_queueRequest:function(e,t){t.call(this)},_modelLoaded:function(e){var t=this.get(e);t.loaded(!0),t.hasChildren=this.childNodes(t).length>0},_modelError:function(e,t){this.get(e)._error=t},read:function(e){return e&&e.id||(this._data=this._observe([])),v.fn.read.call(this,e)},load:function(t){var n="_query",i=this.options.serverSorting||this.options.serverPaging||this.options.serverFiltering||this.options.serverGrouping||this.options.serverAggregates,r=e.Deferred().resolve().promise();if(t.loaded()){if(i)return r}else t.hasChildren&&(n="read");return this[n]({id:t.id}).then(b(this._modelLoaded,this,t.id),b(this._modelError,this,t.id))},_byParentId:function(e,t){var n,i,r=[],o=this.view();if(e===t)return[];for(i=0;o.length>i;i++)n=o.at(i),n.parentId==e&&r.push(n);return r},_defaultParentId:function(){return this.reader.model.fn.defaults.parentId},childNodes:function(e){return this._byParentId(e.id,this._defaultParentId())},rootNodes:function(){return this._byParentId(this._defaultParentId())},parentNode:function(e){return this.get(e.parentId)},level:function(e){var t=-1;e instanceof et||(e=this.get(e));do e=this.parentNode(e),t++;while(e);return t},filter:function(e){var n=v.fn.filter;return e===t?n.call(this,e):(n.call(this,e),t)}});tt.create=function(t){return e.isArray(t)?t={data:t}:t instanceof _&&(t={data:t.toJSON()}),t instanceof tt?t:new tt(t)},a=kendo.Observable.extend({init:function(e,t){kendo.Observable.fn.init.call(this),t=this.options=d(!0,{},this.options,t),this.element=e,this.bind(this.events,t),this.model=this.options.model,this.fields=this._fields(this.options.columns),this._initContainer(),this.createEditable()},events:[],_initContainer:function(){this.wrapper=this.element},createEditable:function(){var e=this.options;this.editable=new g.Editable(this.wrapper,{fields:this.fields,target:e.target,clearContainer:e.clearContainer,model:this.model})},_isEditable:function(e){return e.field&&this.model.editable(e.field)},_fields:function(e){var t,n,i,r=[];for(t=0,n=e.length;n>t;t++)i=e[t],this._isEditable(i)&&r.push({field:i.field,format:i.format,editor:i.editor});return r},end:function(){return this.editable.end()},close:function(){this.destroy()},destroy:function(){this.editable.destroy(),this.editable.element.find("["+kendo.attr("container-for")+"]").empty().end().removeAttr(kendo.attr("role")),this.model=this.wrapper=this.element=this.columns=this.editable=null}}),s=a.extend({init:function(e,t){a.fn.init.call(this,e,t),this._attachHandlers(),this.open()},events:[U,R],options:{window:{modal:!0,resizable:!1,draggable:!0,title:"Edit",visible:!1}},_initContainer:function(){var t=this.options,n=[];this.wrapper=e('<div class="k-popup-edit-form"/>').attr(kendo.attr("uid"),this.model.uid).append('<div class="k-edit-form-container"/>'),t.template?(this._appendTemplate(n),this.fields=[]):this._appendFields(n),this._appendButtons(n),new u.Tree(this.wrapper.children()[0]).render(n),this.wrapper.appendTo(t.appendTo),this.window=new g.Window(this.wrapper,t.window)},_appendTemplate:function(e){var t=this.options.template;typeof t===A&&(t=window.unescape(t)),t=kendo.template(t)(this.model),e.push(p(t))},_appendFields:function(e){var t,n,i,r=this.options.columns;for(t=0,n=r.length;n>t;t++)i=r[t],i.command||(e.push(p('<div class="k-edit-label"><label for="'+i.field+'">'+(i.title||i.field||"")+"</label></div>")),e.push(this._isEditable(i)?p("<div "+kendo.attr("container-for")+'="'+i.field+'" class="k-edit-field"></div>'):h("div",{"class":"k-edit-field"},[this.options.fieldRenderer(i,this.model)])))},_appendButtons:function(e){e.push(h("div",{"class":"k-edit-buttons k-state-default"},this.options.commandRenderer()))},_attachHandlers:function(){var e=this._cancelProxy=b(this._cancel,this);this.wrapper.on(I+z,".k-grid-cancel",this._cancelProxy),this._saveProxy=b(this._save,this),this.wrapper.on(I+z,".k-grid-update",this._saveProxy),this.window.bind("close",function(t){t.userTriggered&&e(t)})},_dettachHandlers:function(){this._cancelProxy=null,this._saveProxy=null,this.wrapper.off(z)},_cancel:function(e){this.trigger(U,e)},_save:function(){this.trigger(R)},open:function(){this.window.center().open()},close:function(){this.window.bind("deactivate",b(this.destroy,this)).close()},destroy:function(){this.window.destroy(),this.window=null,this._dettachHandlers(),a.fn.destroy.call(this)}}),l=m.extend({init:function(t,n){if(m.fn.init.call(this,t,n),this._dataSource(this.options.dataSource),this._columns(),this._layout(),this._selectable(),this._sortable(),this._resizable(),this._filterable(),this._attachEvents(),this._toolbar(),this._scrollable(),this._reorderable(),this._columnMenu(),this.options.autoBind&&this.dataSource.fetch(),this._hasLockedColumns){var i=this;this.wrapper.addClass("k-grid-lockedcolumns"),this._resizeHandler=function(){i.resize()},e(window).on("resize"+z,this._resizeHandler)}kendo.notify(this)},_scrollable:function(){var t,n,i;this.options.scrollable&&(t=this.thead.closest(".k-grid-header-wrap"),n=e(this.lockedContent).bind("DOMMouseScroll"+z+" mousewheel"+z,b(this._wheelScroll,this)),this.content.bind("scroll"+z,function(){t.scrollLeft(this.scrollLeft),n.scrollTop(this.scrollTop)}),i=kendo.touchScroller(this.content),i&&i.movable&&(this._touchScroller=i,i.movable.bind("change",function(e){t.scrollLeft(-e.sender.x),n&&n.scrollTop(-e.sender.y)})))},_wheelScroll:function(t){if(!t.ctrlKey){var n=kendo.wheelDeltaY(t);n&&(t.preventDefault(),e(t.currentTarget).one("wheel"+z,!1),this.content.scrollTop(this.content.scrollTop()+-n))}},_progress:function(){var e=this.options.messages;this.tbody.find("tr").length||this._showStatus(kendo.template("<span class='#= className #' /> #: messages.loading #")({className:J.icon+" "+J.loading,messages:e}))},_error:function(e){this.dataSource.rootNodes().length||this._render({error:e})},refresh:function(e){e=e||{},"itemchange"==e.action&&this.editor||this.trigger(H)||(this._cancelEditor(),this._render(),this._adjustHeight(),this.trigger(V))},_angularFooters:function(e){var t,n,i,r=this.dataSource.aggregates(),o=this._footerItems();for(t=0;o.length>t;t++)n=o.eq(t),i=r[n.attr("data-parentId")],this._angularFooter(e,n.find("td").get(),i)},_angularFooter:function(e,t,n){var i=this.columns;this.angular(e,function(){return{elements:t,data:x(i,function(e){return{column:e,aggregate:n&&n[e.field]}})}})},items:function(){return this._hasLockedColumns?this._items(this.tbody).add(this._items(this.lockedTable)):this._items(this.tbody)},_items:function(t){return t.find("tr").filter(function(){return!e(this).hasClass(J.footerTemplate)})},_footerItems:function(){var t=this.tbody;return this._hasLockedColumns&&(t=t.add(this.lockedTable)),t.find("tr").filter(function(){return e(this).hasClass(J.footerTemplate)})},dataItems:function(){var e,t,n,i=kendo.ui.DataBoundWidget.fn.dataItems.call(this);if(this._hasLockedColumns){for(e=i.length,t=Array(2*e),n=e;--n>=0;)t[n]=t[n+e]=i[n];i=t}return i},_showStatus:function(t){var n=this.element.find(".k-status"),i=e(this.content).add(this.lockedContent);n.length||(n=e("<div class='k-status' />").appendTo(this.element)),this._contentTree.render([]),this._hasLockedColumns&&this._lockedContentTree.render([]),i.hide(),n.html(t)},_hideStatus:function(){this.element.find(".k-status").remove(),e(this.content).add(this.lockedContent).show()},_adjustHeight:function(){var e,t,n=this.element,i=n.find(P+J.gridContentWrap),r=n.find(P+J.gridHeader),o=n.find(P+J.gridToolbar),a=kendo.support.scrollbar();n.height(this.options.height),t=function(e){var t,n;return e[0].style.height?!0:(t=e.height(),e.height("auto"),n=e.height(),e.height(""),t!=n)},t(n)&&(e=n.height()-r.outerHeight()-o.outerHeight(),i.height(e),this._hasLockedColumns&&(a=this.table[0].offsetWidth>this.table.parent()[0].clientWidth?a:0,this.lockedContent.height(e-a)))},_resize:function(){this._applyLockedContainersWidth(),this._adjustHeight()},destroy:function(){m.fn.destroy.call(this);var t=this.dataSource;t.unbind(D,this._refreshHandler),t.unbind(M,this._errorHandler),t.unbind(E,this._progressHandler),this._resizeHandler&&e(window).off("resize"+z,this._resizeHandler),this.resizable&&(this.resizable.destroy(),this.resizable=null),this.reorderable&&(this.reorderable.destroy(),this.reorderable=null),this._draggableInstance&&this._draggableInstance.element&&(this._draggableInstance.destroy(),this._draggableInstance=null),this._destroyEditor(),this.element.off(z),this._touchScroller&&this._touchScroller.destroy(),this._autoExpandable=null,this._refreshHandler=this._errorHandler=this._progressHandler=null,this.thead=this.content=this.tbody=this.table=this.element=this.lockedHeader=this.lockedContent=null,this._statusTree=this._headerTree=this._contentTree=this._lockedHeaderColsTree=this._lockedContentColsTree=this._lockedHeaderTree=this._lockedContentTree=null},options:{name:"TreeList",columns:[],autoBind:!0,scrollable:!0,selectable:!1,sortable:!1,toolbar:null,height:null,columnMenu:!1,messages:{noRows:"No records to display",loading:"Loading...",requestFailed:"Request failed.",retry:"Retry",commands:{edit:"Edit",update:"Update",canceledit:"Cancel",create:"Add new record",createchild:"Add child record",destroy:"Delete",excel:"Export to Excel",pdf:"Export to PDF"}},excel:{hierarchy:!0},resizable:!1,filterable:!1,editable:!1,reorderable:!1},events:[D,L,R,N,F,O,H,V,U,W,j,G,$,Y,K,Q,X],_toggle:function(e,n){var i=e.loaded();e._error&&(e.expanded=!1,e._error=t),(i||!e.expanded)&&(t===n&&(n=!e.expanded),e.expanded=n,i||this.dataSource.load(e).always(b(function(){this._render()},this)),this._render())},expand:function(e){this._toggle(this.dataItem(e),!0)},collapse:function(e){this._toggle(this.dataItem(e),!1)},_toggleChildren:function(t){var n=e(t.currentTarget),i=this.dataItem(n),r=i.expanded?O:F;this.trigger(r,{model:i})||this._toggle(i),t.preventDefault()},_attachEvents:function(){var e=P+J.iconCollapse+", ."+J.iconExpand+", ."+J.refresh,t=P+J.retry,n=this.dataSource;this.element.on(B+z,e,b(this._toggleChildren,this)).on(I+z,t,b(n.fetch,n)).on(I+z,".k-button[data-command]",b(this._commandClick,this))},_commandByName:function(t){var n,i,r,o,a=this.columns,s=e.isArray(this.options.toolbar)?this.options.toolbar:[];if(t=t.toLowerCase(),Z[t])return Z[t];for(n=0;a.length>n;n++)if(r=a[n].command)for(i=0;r.length>i;i++)if(o=r[i].name,o&&o.toLowerCase()==t)return r[i];for(n=0;s.length>n;n++)if(o=s[n].name,o&&o.toLowerCase()==t)return s[n]},_commandClick:function(n){var i=e(n.currentTarget),r=i.attr("data-command"),o=this._commandByName(r),a=i.parentsUntil(this.wrapper,"tr");a=a.length?a:t,o&&(o.methodName?this[o.methodName](a):o.click&&o.click.call(this,n),n.preventDefault())},_ensureExpandableColumn:function(){var e,t;this._autoExpandable&&delete this._autoExpandable.expandable,e=k(this.columns,i(n("hidden"))),t=k(e,n("expandable")),this.columns.length&&!t.length&&(this._autoExpandable=e[0],e[0].expandable=!0)},_columns:function(){var e,t=this.options.columns||[];this.columns=x(t,function(e){return e="string"==typeof e?{field:e}:e,d({encoded:!0},e)}),e=this._lockedColumns(),e.length>0&&(this._hasLockedColumns=!0,this.columns=e.concat(this._nonLockedColumns())),this._ensureExpandableColumn(),this._columnTemplates(),this._columnAttributes()},_columnTemplates:function(){var e,t,n,i=this.columns;for(e=0,t=i.length;t>e;e++)n=i[e],n.template&&(n.template=kendo.template(n.template)),n.headerTemplate&&(n.headerTemplate=kendo.template(n.headerTemplate)),n.footerTemplate&&(n.footerTemplate=kendo.template(n.footerTemplate))},_columnAttributes:function(){function t(t){var n,i,r,o;if(t&&t.style)for(n=t.style.split(";"),t.style={},i=0;n.length>i;i++)r=n[i].split(":"),o=e.trim(r[0]),o&&(t.style[e.camelCase(o)]=e.trim(r[1]))}var n,i,r=this.columns;for(n=0,i=r.length;i>n;n++)t(r[n].attributes),t(r[n].headerAttributes)},_layout:function(){var e,t,n=this.columns,i=this.element,r="";this.wrapper=i.addClass(J.wrapper),r="<div class='#= gridHeader #' style=\"padding-right: "+kendo.support.scrollbar()+'px;">',this._hasLockedColumns&&(r+="<div class='k-grid-header-locked'><table role='grid'><colgroup></colgroup><thead role='rowgroup' /></table></div>"),r+="<div class='#= gridHeaderWrap #'><table role='grid'><colgroup></colgroup><thead role='rowgroup' /></table></div></div>",this._hasLockedColumns&&(r+="<div class='k-grid-content-locked'><table role='treegrid' tabindex='0'><colgroup></colgroup><tbody /></table></div>"),r+="<div class='#= gridContentWrap #'><table role='treegrid' tabindex='0'><colgroup></colgroup><tbody /></table></div>",this.options.scrollable||(r="<table role='treegrid' tabindex='0'><colgroup></colgroup><thead class='#= gridHeader #' role='rowgroup' /><tbody /></table>"),this.options.toolbar&&(r="<div class='#= header # #= gridToolbar #' />"+r),i.append(kendo.template(r)(J)+"<div class='k-status' />"),this.toolbar=i.find(P+J.gridToolbar),e=i.find(P+J.gridHeader).find("thead").addBack().filter("thead"),this.thead=e.last(),t=i.find(P+J.gridContentWrap),t.length?this.content=t:t=i,this.table=t.find(">table"),this.tbody=this.table.find(">tbody"),this._hasLockedColumns&&(this.lockedHeader=e.first().closest(".k-grid-header-locked"),this.lockedContent=i.find(".k-grid-content-locked"),this.lockedTable=this.lockedContent.children()),this._initVirtualTrees(),this._renderCols(),this._renderHeader(),this.angular("compile",function(){return{elements:e.find("th.k-header").get(),data:x(n,function(e){return{column:e}})}})},_initVirtualTrees:function(){this._headerColsTree=new u.Tree(this.thead.prev()[0]),this._contentColsTree=new u.Tree(this.tbody.prev()[0]),this._headerTree=new u.Tree(this.thead[0]),this._contentTree=new u.Tree(this.tbody[0]),this._statusTree=new u.Tree(this.element.children(".k-status")[0]),this.lockedHeader&&(this._lockedHeaderColsTree=new u.Tree(this.lockedHeader.find("colgroup")[0]),this._lockedContentColsTree=new u.Tree(this.lockedTable.find(">colgroup")[0]),this._lockedHeaderTree=new u.Tree(this.lockedHeader.find("thead")[0]),this._lockedContentTree=new u.Tree(this.lockedTable.find(">tbody")[0]))},_toolbar:function(){var t,n=this.options.toolbar,i=this.toolbar;n&&(e.isArray(n)?(t=this._buildCommands(n),new u.Tree(i[0]).render(t)):i.append(kendo.template(n)({})),this.angular("compile",function(){return{elements:i.get()}}))},_lockedColumns:function(){return k(this.columns,n("locked"))},_nonLockedColumns:function(){return k(this.columns,i(n("locked")))},_render:function(t){var n,i,r,o;t=t||{},n=this.options.messages,i=this.dataSource.rootNodes(),r=this.dataSource.aggregates(),o=this.select().map(function(t,n){return e(n).attr("data-uid")}),this._absoluteIndex=0,this._angularItems("cleanup"),this._angularFooters("cleanup"),t.error?this._showStatus(kendo.template("#: messages.requestFailed # <button class='#= buttonClass #'>#: messages.retry #</button>")({buttonClass:[J.button,J.retry].join(" "),messages:n})):i.length?(this._hideStatus(),this._contentTree.render(this._trs({columns:this._nonLockedColumns(),aggregates:t.aggregates,selected:o,data:i,visible:!0,level:0})),this._hasLockedColumns&&(this._absoluteIndex=0,this._lockedContentTree.render(this._trs({columns:this._lockedColumns(),aggregates:t.aggregates,selected:o,data:i,visible:!0,level:0})))):this._showStatus(kendo.htmlEncode(n.noRows)),this._touchScroller&&this._touchScroller.contentResized(),this._angularItems("compile"),this._angularFooters("compile"),this._adjustRowsHeight()},_adjustRowsHeight:function(){var e,t,n,i,r,o,a,s,l,c,d,u,h,f;if(this._hasLockedColumns){for(e=this.table,t=this.lockedTable,n=e[0].rows,i=n.length,o=t[0].rows,a=e.add(t),s=a.length,l=[],c=this.lockedHeader.find("tr"),d=this.thead.find("tr"),c.add(d).height("auto").height(Math.max(c.height(),d.height())),r=0;i>r&&o[r];r++)n[r].style.height&&(n[r].style.height=o[r].style.height=""),u=n[r].offsetHeight,h=o[r].offsetHeight,f=0,u>h?f=u:h>u&&(f=h),l.push(f);for(r=0;s>r;r++)a[r].style.display="none";for(r=0;i>r;r++)l[r]&&(n[r].style.height=o[r].style.height=l[r]+1+"px");for(r=0;s>r;r++)a[r].style.display=""}},_ths:function(e){var t,n,i,r,o,a,s,l,c=[];for(s=0,l=e.length;l>s;s++)t=e[s],i=[],r=[J.header],n=t.headerTemplate?t.headerTemplate({}):t.title||t.field||"",a=t.headerTemplate?p(n):f(n),i.push(t.sortable?h("a",{href:"#",className:J.link},[a]):a),o={"data-field":t.field,"data-title":t.title,style:t.hidden===!0?{display:"none"}:{},className:r.join(" "),role:"columnheader"},o=d(!0,{},o,t.headerAttributes),c.push(h("th",o,i));return c},_cols:function(e){var t,n,i,r=[];for(i=0;e.length>i;i++)e[i].hidden!==!0&&(t=e[i].width,n={},t&&0!==parseInt(t,10)&&(n.style={width:"string"==typeof t?t:t+"px"}),r.push(h("col",n)));return r},_renderCols:function(){var e=this._nonLockedColumns();this._headerColsTree.render(this._cols(e)),this.options.scrollable&&this._contentColsTree.render(this._cols(e)),this._hasLockedColumns&&(e=this._lockedColumns(),this._lockedHeaderColsTree.render(this._cols(e)),this._lockedContentColsTree.render(this._cols(e)))},_renderHeader:function(){var e=this._nonLockedColumns();this._headerTree.render([h("tr",{role:"row"},this._ths(e))]),this._hasLockedColumns&&(e=this._lockedColumns(),this._lockedHeaderTree.render([h("tr",{role:"row"},this._ths(e))]),this._applyLockedContainersWidth())},_applyLockedContainersWidth:function(){var e,t,n,i,r,a;this._hasLockedColumns&&(e=o(this.lockedHeader.find(">table>colgroup>col")),t=this.thead.parent(),n=o(t.find(">colgroup>col")),i=this.wrapper[0].clientWidth,r=kendo.support.scrollbar(),e>=i&&(e=i-3*r),this.lockedHeader.add(this.lockedContent).width(e),t.add(this.table).width(n),a=i-e-2,this.content.width(a),t.parent().width(a-r))},_trs:function(t){var n,i,r,o,a,s,l,c,d=[],u=t.level,h=t.data,f=this.dataSource,p=f.aggregates()||{},g=t.columns;for(s=0,l=h.length;l>s;s++)r=[],n=h[s],a=n.loaded()&&f.childNodes(n),o=a&&a.length,i={"data-uid":n.uid,role:"row"},o&&(i["aria-expanded"]=!!n.expanded),t.visible?(this._absoluteIndex%2!==0&&r.push(J.alt),this._absoluteIndex++):i.style={display:"none"},e.inArray(n.uid,t.selected)>=0&&r.push(J.selected),o&&r.push(J.group),n._edit&&r.push("k-grid-edit-row"),i.className=r.join(" "),d.push(this._tds({model:n,attr:i,level:u},g,b(this._td,this))),o&&(d=d.concat(this._trs({columns:g,parentId:n.id,aggregates:p,selected:t.selected,visible:t.visible&&!!n.expanded,data:a,level:u+1})));return this._hasFooterTemplate()&&(c=t.parentId||null,i={className:J.footerTemplate,"data-parentId":c},t.visible||(i.style={display:"none"}),d.push(this._tds({model:p[c],attr:i,level:u},g,this._footerTd))),d},_footerTd:function(t){var n=[],i=t.column,o=t.column.footerTemplate||e.noop,a=t.model[i.field]||{},s={role:"gridcell",style:i.hidden===!0?{display:"none"}:{}};return i.expandable&&(n=n.concat(r({level:t.level+1,className:J.iconPlaceHolder}))),i.attributes&&d(s,i.attributes),n.push(p(o(a)||"")),h("td",s,n)},_hasFooterTemplate:function(){return!!k(this.columns,function(e){return e.footerTemplate}).length},_tds:function(e,t,n){var i,r,o,a=[];for(r=0,o=t.length;o>r;r++)i=t[r],a.push(n({model:e.model,column:i,level:e.level}));return h("tr",e.attr,a)},_td:function(e){var t,n=[],i=e.model,o=e.column,a={role:"gridcell",style:o.hidden===!0?{display:"none"}:{}};return i._edit&&o.field&&i.editable(o.field)?a[kendo.attr("container-for")]=o.field:(o.expandable&&(n=r({level:e.level,className:J.iconPlaceHolder}),t=[J.icon],t.push(i.hasChildren?i.expanded?J.iconCollapse:J.iconExpand:J.iconHidden),i._error?t.push(J.refresh):!i.loaded()&&i.expanded&&t.push(J.loading),n.push(h("span",{className:t.join(" ")})),a.style["white-space"]="nowrap"),o.attributes&&d(!0,a,o.attributes),o.command?n=this._buildCommands(i._edit?["update","canceledit"]:o.command):n.push(this._cellContent(o,i))),h("td",a,n)},_cellContent:function(e,n){var i;return e.template?i=e.template(n):e.field&&(i=n.get(e.field),e.format&&(i=kendo.format(e.format,i))),(null===i||t===i)&&(i=""),e.template||!e.encoded?p(i):f(i)},_buildCommands:function(e){var t,n=[];for(t=0;e.length>t;t++)n.push(this._button(e[t]));return n},_button:function(e){var t=(e.name||e).toLowerCase(),n=this.options.messages.commands[t],i=[];return e=d({},Z[t],{text:n},e),e.imageClass&&i.push(h("span",{className:["k-icon",e.imageClass].join(" ")})),h("button",{"data-command":t,className:["k-button k-button-icontext",e.className].join(" ")},i.concat([f(e.text||e.name)]))},_positionResizeHandle:function(t){var n,i=e(t.currentTarget),r=3,o=this.resizeHandle,a=i.position(),s=a.left,l=i.outerWidth(),c=i.closest(".k-grid-header-wrap,.k-grid-header-locked,.k-treelist");s+=c.scrollLeft(),o||(o=this.resizeHandle=e('<div class="k-resize-handle"><div class="k-resize-handle-inner" /></div>')),c.append(o),t.clientX>s+l/2?s+=l:i=i.prev(),n=!!i.length&&s>r,o.toggle(n).css({top:a.top,left:s-r-1,height:i.outerHeight(),width:3*r}).data("th",i)},_resizable:function(){if(this.options.resizable){this.resizable&&this.resizable.destroy();var t=this;e(this.lockedHeader).find("thead").add(this.thead).on("mousemove"+z,"th",e.proxy(this._positionResizeHandle,this)),this.resizable=new kendo.ui.Resizable(this.wrapper,{handle:".k-resize-handle",start:function(n){var i,r,o=e(n.currentTarget).data("th"),a="col:eq("+o.index()+")";t.wrapper.addClass("k-grid-column-resizing"),t.lockedHeader&&e.contains(t.lockedHeader[0],o[0])?(i=t.lockedHeader,r=t.lockedTable):(i=t.thead.parent(),r=t.table),this.col=r.children("colgroup").find(a).add(i.find(a)),this.th=o,this.startLocation=n.x.location,this.columnWidth=o.outerWidth(),this.table=this.col.closest("table"),this.totalWidth=this.table.width()},resize:function(e){var t=11,n=e.x.location-this.startLocation;t>this.columnWidth+n&&(n=t-this.columnWidth),this.table.width(this.totalWidth+n),this.col.width(this.columnWidth+n)},resizeend:function(){var e,n,i;t.wrapper.removeClass("k-grid-column-resizing"),e=this.th.attr("data-field"),n=k(t.columns,function(t){return t.field==e}),i=Math.floor(this.th.outerWidth()),n[0].width=i,t._resize(),t._adjustRowsHeight(),t.trigger(Y,{column:n,oldWidth:this.columnWidth,newWidth:i}),this.table=this.col=this.th=null}})}},_sortable:function(){var t,n,i,r,o,a=this.columns,s=e(this.lockedHeader).add(this.thead).find("th"),l=kendo.attr("field"),c=this.options.sortable;if(c)for(r=0,o=s.length;o>r;r++)t=a[r],t.sortable!==!1&&!t.command&&t.field&&(i=s.eq(r),n=i.data("kendoColumnSorter"),n&&n.destroy(),i.attr(l,t.field).kendoColumnSorter(d({},c,t.sortable,{dataSource:this.dataSource})))},_filterable:function(){var t,n,i,r,o,a,s=e(this.lockedHeader).add(this.thead).find("th"),l=this.options.filterable;if(l&&!this.options.columnMenu)for(a=b(function(e){this.trigger(W,{field:e.field,container:e.container})},this),t=0,n=s.length;n>t;t++)i=this.columns[t],r=s.eq(t),o=r.data("kendoFilterMenu"),o&&o.destroy(),i.command||i.filterable===!1||r.kendoFilterMenu(d(!0,{},l,i.filterable,{dataSource:this.dataSource,init:a}))},_change:function(){this.trigger(D)},_selectable:function(){var e,n,i=this.options.selectable,r=this.table;i&&(i=kendo.ui.Selectable.parseOptions(i),this._hasLockedColumns&&(r=r.add(this.lockedTable),n=i.multiple&&i.cell),e=">tbody>tr:not(.k-footer-template)",i.cell&&(e+=">td"),this.selectable=new kendo.ui.Selectable(r,{filter:e,aria:!0,multiple:i.multiple,change:b(this._change,this),useAllItems:n,continuousItems:b(this._continuousItems,this,e,i.cell),relatedTarget:!i.cell&&this._hasLockedColumns?b(this._selectableTarget,this):t}))},_continuousItems:function(t,n){var i,r,o,a,s,l;if(this.lockedContent){for(i=e(t,this.lockedTable),r=e(t,this.table),o=n?this._lockedColumns().length:1,a=n?this.columns.length-o:1,s=[],l=0;i.length>l;l+=o)T.apply(s,i.slice(l,l+o)),T.apply(s,r.splice(0,a));return s}},_selectableTarget:function(t){var n,i,r,o=e();for(i=0,r=t.length;r>i;i++)n=this._relatedRow(t[i]),S(n[0],t)<0&&(o=o.add(n));return o},_relatedRow:function(t){var n,i,r=this.lockedTable;return t=e(t),r?(n=t.closest(this.table.add(this.lockedTable)),i=n.find(">tbody>tr").index(t),n=n[0]===this.table[0]?r:this.table,n.find(">tbody>tr").eq(i)):t},select:function(n){var i=this.selectable;return i?(t!==n&&(i.options.multiple||(i.clear(),n=n.first()),this._hasLockedColumns&&(n=n.add(e.map(n,b(this._relatedRow,this))))),i.value(n)):e()},clearSelection:function(){var e=this.select();e.length&&(this.selectable.clear(),this.trigger(D))},_dataSource:function(e){var t=this.dataSource;t&&(t.unbind(D,this._refreshHandler),t.unbind(M,this._errorHandler),t.unbind(E,this._progressHandler)),this._refreshHandler=b(this.refresh,this),this._errorHandler=b(this._error,this),this._progressHandler=b(this._progress,this),t=this.dataSource=tt.create(e),t.bind(D,this._refreshHandler),t.bind(M,this._errorHandler),t.bind(E,this._progressHandler)},setDataSource:function(e){this._dataSource(e),this._sortable(),this._filterable(),this._contentTree.render([]),this.options.autoBind&&this.dataSource.fetch()},dataItem:function(t){var n=e(t).closest("tr"),i=this.dataSource.getByUid(n.attr(kendo.attr("uid")));return i},editRow:function(e){var t;typeof e===A&&(e=this.tbody.find(e)),t=this.dataItem(e),t&&("popup"!=this._editMode()&&(t._edit=!0),this._cancelEditor(),this._render(),this._createEditor(t),this.trigger(L,{container:this.editor.wrapper,model:t}))},_cancelEdit:function(e){e=d(e,{container:this.editor.wrapper,model:this.editor.model}),this.trigger(U,e)||this.cancelRow()},cancelRow:function(){this._cancelEditor(),this._render()},saveRow:function(){var e,t=this.editor;t&&(e={model:t.model,container:t.wrapper},t.end()&&!this.trigger(R,e)&&this.dataSource.sync())},addRow:function(e){var n=this.editor,i=0,r={};if(!n||n.end())return e?(e instanceof et||(e=this.dataItem(e)),r.parentId=e.id,i=this.dataSource.indexOf(e)+1,e.set("expanded",!0),this.dataSource.load(e).then(b(this._insertAt,this,r,i)),t):(this._insertAt(r,i),t)},_insertAt:function(e,t){e=this.dataSource.insert(t,e);var n=this.tbody.find("["+kendo.attr("uid")+"="+e.uid+"]");this.editRow(n)},removeRow:function(e){var t=this.dataItem(e),n={model:t,row:e};t&&!this.trigger(N,n)&&(this.dataSource.remove(t),this.dataSource.sync())},_cancelEditor:function(){var e,t=this.editor;t&&(e=t.model,this._destroyEditor(),this.dataSource.cancelChanges(e),e._edit=!1)},_destroyEditor:function(){this.editor&&(this.editor.close(),this.editor=null)},_createEditor:function(e){var t,n,i=this.tbody.find("["+kendo.attr("uid")+"="+e.uid+"]");i=i.add(this._relatedRow(i)),t=this._editMode(),n={columns:this.columns,model:e,target:this,clearContainer:!1,template:this.options.editable.template},"inline"==t?this.editor=new a(i,n):(d(n,{window:this.options.editable.window,commandRenderer:b(function(){return this._buildCommands(["update","canceledit"])},this),fieldRenderer:this._cellContent,save:b(this.saveRow,this),cancel:b(this._cancelEdit,this),appendTo:this.wrapper}),this.editor=new s(i,n))},_editMode:function(){var e="inline",t=this.options.editable;return t!==!0&&(e="string"==typeof t?t:t.mode||e),e.toLowerCase()},hideColumn:function(e){this._toggleColumnVisibility(e,!0)},showColumn:function(e){this._toggleColumnVisibility(e,!1)
},_toggleColumnVisibility:function(e,t){e=this._findColumn(e),e&&e.hidden!==t&&(e.hidden=t,this._ensureExpandableColumn(),this._renderCols(),this._renderHeader(),this._render(),this._adjustTablesWidth(),this.trigger(t?j:G,{column:e}),t||e.width||this.table.add(this.thead.closest("table")).width(""))},_findColumn:function(e){return e="number"==typeof e?this.columns[e]:C(e)?k(this.columns,function(t){return t===e})[0]:k(this.columns,function(t){return t.field===e})[0]},_adjustTablesWidth:function(){var e,t,n,i=this.thead.prev().children(),r=0;for(e=0,t=i.length;t>e;e++){if(n=i[e].style.width,!n||-1!=n.indexOf("%")){r=0;break}r+=parseInt(n,10)}r&&this.table.add(this.thead.closest("table")).width(r)},_reorderable:function(){var t,n,i;this.options.reorderable&&(t=this.options.scrollable===!0,n=(t?".k-grid-header:first ":"table:first>.k-grid-header ")+q,i=this,this._draggableInstance=new g.Draggable(this.wrapper,{group:kendo.guid(),filter:n,hint:function(t){return e('<div class="k-header k-drag-clue" />').css({width:t.width(),paddingLeft:t.css("paddingLeft"),paddingRight:t.css("paddingRight"),lineHeight:t.height()+"px",paddingTop:t.css("paddingTop"),paddingBottom:t.css("paddingBottom")}).html(t.attr(kendo.attr("title"))||t.attr(kendo.attr("field"))||t.text()).prepend('<span class="k-icon k-drag-status k-denied" />')}}),this.reorderable=new g.Reorderable(this.wrapper,{draggable:this._draggableInstance,dragOverContainers:b(this._allowDragOverContainers,this),inSameContainer:function(t){return e(t.source).parent()[0]===e(t.target).parent()[0]},change:function(e){var t=e.newIndex,n=e.oldIndex,r="before"===e.position,o=i.columns[n];i.trigger($,{newIndex:t,oldIndex:n,column:o}),i.reorderColumn(t,o,r)}}))},_allowDragOverContainers:function(e){return this.columns[e].lockable!==!1},reorderColumn:function(n,i,r){var o,a,s,l=this.columns,c=S(i,l),d=l[n],u=!!d.locked,h=this._nonLockedColumns().length;c!==n&&(!u||i.locked||1!=h)&&(u||!i.locked||l.length-h!=1)&&(r===t&&(r=c>n),o=!!i.locked,o=o!=u,i.locked=u,l.splice(r?n:n+1,0,i),l.splice(n>c?c:c+1,1),this._renderCols(),a=e(this.lockedHeader).add(this.thead).find("th"),a.eq(c)[r?"insertBefore":"insertAfter"](a.eq(n)),s=this._headerTree.children[0].children,this._hasLockedColumns&&(s=this._lockedHeaderTree.children[0].children.concat(s)),s.splice(r?n:n+1,0,s[c]),s.splice(n>c?c:c+1,1),this._hasLockedColumns&&(this._lockedHeaderTree.children[0].children=s.splice(0,this._lockedColumns().length),this._headerTree.children[0].children=s),this._applyLockedContainersWidth(),this.refresh(),o&&(u?this.trigger(Q,{column:i}):this.trigger(X,{column:i})))},lockColumn:function(e){var t,n=this.columns;e="number"==typeof e?n[e]:k(n,function(t){return t.field===e})[0],e&&!e.hidden&&(t=this._lockedColumns().length-1,this.reorderColumn(t,e,!1))},unlockColumn:function(e){var t,n=this.columns;e="number"==typeof e?n[e]:k(n,function(t){return t.field===e})[0],e&&!e.hidden&&(t=this._lockedColumns().length,this.reorderColumn(t,e,!0))},_columnMenu:function(){var t,n,i,r,o,a,s=e(this.lockedHeader).add(this.thead).find("th"),l=this.columns,c=this.options,u=c.columnMenu,h=b(this._columnMenuInit,this),f=this._lockedColumns().length;if(u)for("boolean"==typeof u&&(u={}),a=0;s.length>a;a++)t=l[a],t.field&&(n=s.eq(a).data("kendoColumnMenu"),n&&n.destroy(),r=!1,t.sortable!==!1&&u.sortable!==!1&&c.sortable!==!1&&(r=d({},c.sortable,{compare:(t.sortable||{}).compare})),o=!1,c.filterable&&t.filterable!==!1&&u.filterable!==!1&&(o=d({pane:this.pane},t.filterable,c.filterable)),i={dataSource:this.dataSource,values:t.values,columns:u.columns,sortable:r,filterable:o,messages:u.messages,owner:this,closeCallback:e.noop,init:h,pane:this.pane,lockedColumns:t.lockable!==!1&&f>0},c.$angular&&(i.$angular=c.$angular),s.eq(a).kendoColumnMenu(i))},_columnMenuInit:function(e){this.trigger(K,{field:e.field,container:e.container})}}),kendo.ExcelMixin&&kendo.ExcelMixin.extend(l.prototype),kendo.PDFMixin&&kendo.PDFMixin.extend(l.prototype),d(!0,kendo.data,{TreeListDataSource:tt,TreeListModel:et}),d(!0,kendo.ui,{TreeList:l}),g.plugin(l)}(window.kendo.jQuery),window.kendo},"function"==typeof define&&define.amd?define:function(e,t){t()});