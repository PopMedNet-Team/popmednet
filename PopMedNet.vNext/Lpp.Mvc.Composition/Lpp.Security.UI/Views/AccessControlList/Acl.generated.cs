#pragma warning disable 1591
//------------------------------------------------------------------------------
// <auto-generated>
//     This code was generated by a tool.
//     Runtime Version:4.0.30319.34014
//
//     Changes to this file may cause incorrect behavior and will be lost if
//     the code is regenerated.
// </auto-generated>
//------------------------------------------------------------------------------

namespace Lpp.Security.UI.Views.AccessControlList
{
    using System;
    using System.Collections.Generic;
    using System.IO;
    using System.Linq;
    using System.Net;
    using System.Text;
    using System.Web;
    using System.Web.Helpers;
    using System.Web.Mvc;
    using System.Web.Mvc.Ajax;
    using System.Web.Mvc.Html;
    using System.Web.Routing;
    using System.Web.Security;
    using System.Web.UI;
    using System.Web.WebPages;
    
    #line 3 "..\..\Views\AccessControlList\Acl.cshtml"
    using Lpp;
    
    #line default
    #line hidden
    using Lpp.Mvc;
    using Lpp.Mvc.Controls;
    
    #line 2 "..\..\Views\AccessControlList\Acl.cshtml"
    using Lpp.Security;
    
    #line default
    #line hidden
    using Lpp.Security.UI;
    using Lpp.Security.UI.Models;
    
    #line 4 "..\..\Views\AccessControlList\Acl.cshtml"
    using Lpp.Utilities;
    
    #line default
    #line hidden
    using Lpp.Utilities.Legacy;
    
    [System.CodeDom.Compiler.GeneratedCodeAttribute("RazorGenerator", "2.0.0.0")]
    [System.Web.WebPages.PageVirtualPathAttribute("~/Views/AccessControlList/Acl.cshtml")]
    public partial class Acl : System.Web.Mvc.WebViewPage<AccessControlListModel>
    {
        public Acl()
        {
        }
        public override void Execute()
        {
WriteLiteral("\r\n");

            
            #line 6 "..\..\Views\AccessControlList\Acl.cshtml"
   this.Stylesheet( "security.min.css" );
   var subjectSelectorHandle = Html.UniqueId();
   var noRecordsMessage = "No access control records found";
   var pEditors = Model.PrivilegeEditors.Select( e => new { e, handle = Html.UniqueId() } ).ToList();
   var id = Html.UniqueId();

            
            #line default
            #line hidden
WriteLiteral("\r\n");

            
            #line 12 "..\..\Views\AccessControlList\Acl.cshtml"
Write(Model.Parameters.SubjectSelector.Render( Html, subjectSelectorHandle ));

            
            #line default
            #line hidden
WriteLiteral("\r\n\r\n<div");

WriteLiteral(" class=\"Acl\"");

WriteAttribute("id", Tuple.Create(" id=\"", 469), Tuple.Create("\"", 477)
            
            #line 14 "..\..\Views\AccessControlList\Acl.cshtml"
, Tuple.Create(Tuple.Create("", 474), Tuple.Create<System.Object, System.Int32>(id
            
            #line default
            #line hidden
, 474), false)
);

WriteLiteral(">\r\n    <input");

WriteLiteral(" type=\"hidden\"");

WriteAttribute("name", Tuple.Create(" name=\"", 505), Tuple.Create("\"", 539)
            
            #line 15 "..\..\Views\AccessControlList\Acl.cshtml"
, Tuple.Create(Tuple.Create("", 512), Tuple.Create<System.Object, System.Int32>(Model.Parameters.FieldName
            
            #line default
            #line hidden
, 512), false)
);

WriteLiteral(" class=\"ValueField\"");

WriteAttribute("value", Tuple.Create("\r\n           value=\"", 559), Tuple.Create("\"", 813)
            
            #line 16 "..\..\Views\AccessControlList\Acl.cshtml"
, Tuple.Create(Tuple.Create("", 579), Tuple.Create<System.Object, System.Int32>(string.Join( ",", from s in Model.InitialEntries
                                     from e in s.OwnEntries
                                     select string.Format( "{0}:{1}:{2}", s.Subject.ID, e.First.SerializedId, e.Second ) )
            
            #line default
            #line hidden
, 579), false)
);

WriteLiteral(" />\r\n");

WriteLiteral("    ");

            
            #line 19 "..\..\Views\AccessControlList\Acl.cshtml"
Write(Html.Render<IGrid>()
        .From( Model.InitialEntries.Select( e => e.Subject ).OrderBy( s => s.DisplayName ) )
        .Attributes( new { @class = "Grid Subjects" } )
        .Column( item => new System.Web.WebPages.HelperResult(__razor_template_writer => {

            
            #line default
            #line hidden
WriteLiteralTo(__razor_template_writer, "<a");

WriteLiteralTo(__razor_template_writer, " class=\"Remove\"");

WriteLiteralTo(__razor_template_writer, " data-id=\"");

            
            #line 22 "..\..\Views\AccessControlList\Acl.cshtml"
             WriteTo(__razor_template_writer, item.ID);

            
            #line default
            #line hidden
WriteLiteralTo(__razor_template_writer, "\"");

WriteLiteralTo(__razor_template_writer, " href=\"#\"");

WriteLiteralTo(__razor_template_writer, ">[remove]</a>");

            
            #line 22 "..\..\Views\AccessControlList\Acl.cshtml"
                                                                          }), c => { } )
        .ClientSideSortColumn( s => s.DisplayName, setOptions: c => c.Title( "Subject" ).Class( "Subject" ) )
        .With( o => o.NoDataMessage = item => new System.Web.WebPages.HelperResult(__razor_template_writer => {

            
            #line default
            #line hidden
            
            #line 24 "..\..\Views\AccessControlList\Acl.cshtml"
             WriteTo(__razor_template_writer, noRecordsMessage);

            
            #line default
            #line hidden
WriteLiteralTo(__razor_template_writer, " ");

            
            #line 24 "..\..\Views\AccessControlList\Acl.cshtml"
                                                                    }))
        .FooterPrefix( item => new System.Web.WebPages.HelperResult(__razor_template_writer => {

            
            #line default
            #line hidden
WriteLiteralTo(__razor_template_writer, "<div");

WriteLiteralTo(__razor_template_writer, " class=\"ActionButtons\"");

WriteLiteralTo(__razor_template_writer, ">\r\n                            <button");

WriteLiteralTo(__razor_template_writer, " class=\"ui-standard-button Add\"");

WriteLiteralTo(__razor_template_writer, ">Add...</button>\r\n                        </div>\r\n");

            
            #line 28 "..\..\Views\AccessControlList\Acl.cshtml"
})        )
    );

            
            #line default
            #line hidden
WriteLiteral("\r\n\r\n    <div");

WriteLiteral(" class=\"PrivilegesBox\"");

WriteLiteral(">\r\n");

            
            #line 32 "..\..\Views\AccessControlList\Acl.cshtml"
        
            
            #line default
            #line hidden
            
            #line 32 "..\..\Views\AccessControlList\Acl.cshtml"
         foreach ( var e in pEditors )
        {

            
            #line default
            #line hidden
WriteLiteral("            ");

            
            #line 34 "..\..\Views\AccessControlList\Acl.cshtml"
             Write(e.e.Render( Html, e.handle ));

            
            #line default
            #line hidden
WriteLiteral("\r\n");

            
            #line 35 "..\..\Views\AccessControlList\Acl.cshtml"
        }

            
            #line default
            #line hidden
WriteLiteral("    </div>\r\n\r\n</div>\r\n<script");

WriteLiteral(" type=\"text/javascript\"");

WriteLiteral(">\r\n    require([\'jQuery\',\'");

            
            #line 40 "..\..\Views\AccessControlList\Acl.cshtml"
                  Write(Html.Raw( this.Resource( "acl.min.js" ) ));

            
            #line default
            #line hidden
WriteLiteral("\',\'");

            
            #line 40 "..\..\Views\AccessControlList\Acl.cshtml"
                                                               Write(subjectSelectorHandle);

            
            #line default
            #line hidden
WriteLiteral("\',\r\n");

WriteLiteral("        ");

            
            #line 41 "..\..\Views\AccessControlList\Acl.cshtml"
   Write(Html.Raw( string.Join( ",", pEditors.Select( e => "'" + e.handle + "'" ) ) ));

            
            #line default
            #line hidden
WriteLiteral("], \r\n        function ($, bind, subjSelector) {\r\n\r\n            var acl = ");

            
            #line 44 "..\..\Views\AccessControlList\Acl.cshtml"
                 Write(Html.Raw( Json.Encode(
                Model.InitialEntries.DistinctBy(pl => pl.Subject.ID).ToDictionary(
                    pl => pl.Subject.ID.ToString(),
                    pl => new
                    {
                        own = pl.OwnEntries.DistinctBy(e => e.First.SerializedId).ToDictionary( e => e.First.SerializedId, e => e.Second == AclEntryKind.Allow ),
                        inherited = pl.InheritedEntries.DistinctBy(e => e.First.SerializedId).ToDictionary( e => e.First.SerializedId, e => new
                            {
                                allow = e.Second.Kind == AclEntryKind.Allow,
                                inheritedFrom = string.Join( " x ", e.Second.InheritedFrom.Elements )
                            } )
                    }
                )
            ) ));

            
            #line default
            #line hidden
WriteLiteral(";\r\n\r\n            bind(acl, \"");

            
            #line 59 "..\..\Views\AccessControlList\Acl.cshtml"
                  Write(id);

            
            #line default
            #line hidden
WriteLiteral("\", subjSelector, \"");

            
            #line 59 "..\..\Views\AccessControlList\Acl.cshtml"
                                       Write(noRecordsMessage);

            
            #line default
            #line hidden
WriteLiteral("\", $.makeArray(arguments).slice(3)); \r\n        }\r\n    );\r\n</script>");

        }
    }
}
#pragma warning restore 1591
