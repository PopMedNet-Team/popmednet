namespace Lpp.Dns.Data.Migrations
{
    using System;
    using System.Data.Entity.Migrations;
    
    public partial class FixRequestTypes : DbMigration
    {
        public override void Up()
        {
            Sql(@"UPDATE RequestTypes SET ProcessorID = '55C48A42-B800-4A55-8134-309CC9954D4C' WHERE ID = 'A4850001-B3A7-4596-80BC-A22200FC06E9'");
            Sql(@"UPDATE RequestTypes SET [Name]='Modular Program: Modular Program', ProcessorID = 'C8BC0BD9-A50D-4B9C-9A25-472827C8640A' WHERE ID = 'BBB00001-16E2-4C53-8AEB-A22200FBAE28'");
            Sql(@"UPDATE RequestTypes SET [Name]='Modular Program: Ad Hoc', ProcessorID = 'C8BC0BD9-A50D-4B9C-9A25-472827C8640A' WHERE ID = '2C880001-5E3D-4032-9ADA-A22200FBC595'");
            Sql(@"UPDATE RequestTypes SET [Name]='Modular Program: Testing', ProcessorID = 'C8BC0BD9-A50D-4B9C-9A25-472827C8640A' WHERE ID = 'EC1A0001-C467-4F03-A2F7-A22200FBDE89'");
            Sql(@"UPDATE RequestTypes SET ProcessorID = '5d630771-8619-41f7-9407-696302e48237' WHERE ID = 'D87F0001-B2E6-4C33-8E9D-A22200FB514E'");
            Sql(@"UPDATE RequestTypes SET [Description] = LTRIM([Description] + ' (No processor id specified)') WHERE ProcessorID IS NULL");

            //Delete requesttypes that do not have processor id assigned and have not been used by a request
            Sql(@"DELETE FROM AclProjectDataMartRequestTypes WHERE
NOT EXISTS(SELECT NULL FROM Requests r WHERE r.RequestTypeID = AclProjectDataMartRequestTypes.RequestTypeID)
AND AclProjectDataMartRequestTypes.RequestTypeID IN ( '5DE1CF20-1CE0-49A2-8767-D8BC5D16D36F', '1BD526D9-46D8-4F66-9191-5731CB8189EE', 'AE85D3E6-93F8-4CB5-BD45-D2F84AB85D83', 'C8BC0BD9-A50D-4B9C-9A25-472827C8640A', '9D0CD143-7DCA-4953-8209-224BDD3AF718', '5D630771-8619-41F7-9407-696302E48237', 'CC14E6A2-99A8-4EF8-B4CB-779A7B93A7BB', '55C48A42-B800-4A55-8134-309CC9954D4C' )");
            Sql(@"DELETE FROM AclDataMartRequestTypes WHERE
NOT EXISTS(SELECT NULL FROM Requests r WHERE r.RequestTypeID = AclDataMartRequestTypes.RequestTypeID)
AND AclDataMartRequestTypes.RequestTypeID IN ( '5DE1CF20-1CE0-49A2-8767-D8BC5D16D36F', '1BD526D9-46D8-4F66-9191-5731CB8189EE', 'AE85D3E6-93F8-4CB5-BD45-D2F84AB85D83', 'C8BC0BD9-A50D-4B9C-9A25-472827C8640A', '9D0CD143-7DCA-4953-8209-224BDD3AF718', '5D630771-8619-41F7-9407-696302E48237', 'CC14E6A2-99A8-4EF8-B4CB-779A7B93A7BB', '55C48A42-B800-4A55-8134-309CC9954D4C' )");
            Sql(@"DELETE FROM AclProjectRequestTypes WHERE
NOT EXISTS(SELECT NULL FROM Requests r WHERE r.RequestTypeID = AclProjectRequestTypes.RequestTypeID)
AND AclProjectRequestTypes.RequestTypeID IN ( '5DE1CF20-1CE0-49A2-8767-D8BC5D16D36F', '1BD526D9-46D8-4F66-9191-5731CB8189EE', 'AE85D3E6-93F8-4CB5-BD45-D2F84AB85D83', 'C8BC0BD9-A50D-4B9C-9A25-472827C8640A', '9D0CD143-7DCA-4953-8209-224BDD3AF718', '5D630771-8619-41F7-9407-696302E48237', 'CC14E6A2-99A8-4EF8-B4CB-779A7B93A7BB', '55C48A42-B800-4A55-8134-309CC9954D4C' )");
            Sql(@"DELETE FROM AclRequestTypes WHERE
NOT EXISTS(SELECT NULL FROM Requests r WHERE r.RequestTypeID = AclRequestTypes.RequestTypeID)
AND AclRequestTypes.RequestTypeID IN ( '5DE1CF20-1CE0-49A2-8767-D8BC5D16D36F', '1BD526D9-46D8-4F66-9191-5731CB8189EE', 'AE85D3E6-93F8-4CB5-BD45-D2F84AB85D83', 'C8BC0BD9-A50D-4B9C-9A25-472827C8640A', '9D0CD143-7DCA-4953-8209-224BDD3AF718', '5D630771-8619-41F7-9407-696302E48237', 'CC14E6A2-99A8-4EF8-B4CB-779A7B93A7BB', '55C48A42-B800-4A55-8134-309CC9954D4C' )");
            Sql(@"DELETE FROM RequestTypeModels WHERE
NOT EXISTS(SELECT NULL FROM Requests r WHERE r.RequestTypeID = RequestTypeModels.RequestTypeID)
AND RequestTypeModels.RequestTypeID IN ( '5DE1CF20-1CE0-49A2-8767-D8BC5D16D36F', '1BD526D9-46D8-4F66-9191-5731CB8189EE', 'AE85D3E6-93F8-4CB5-BD45-D2F84AB85D83', 'C8BC0BD9-A50D-4B9C-9A25-472827C8640A', '9D0CD143-7DCA-4953-8209-224BDD3AF718', '5D630771-8619-41F7-9407-696302E48237', 'CC14E6A2-99A8-4EF8-B4CB-779A7B93A7BB', '55C48A42-B800-4A55-8134-309CC9954D4C' )");
            Sql(@"DELETE FROM RequestTypes WHERE
NOT EXISTS(SELECT NULL FROM Requests r WHERE r.RequestTypeID = RequestTypes.ID)
AND RequestTypes.ID IN ( '5DE1CF20-1CE0-49A2-8767-D8BC5D16D36F', '1BD526D9-46D8-4F66-9191-5731CB8189EE', 'AE85D3E6-93F8-4CB5-BD45-D2F84AB85D83', 'C8BC0BD9-A50D-4B9C-9A25-472827C8640A', '9D0CD143-7DCA-4953-8209-224BDD3AF718', '5D630771-8619-41F7-9407-696302E48237', 'CC14E6A2-99A8-4EF8-B4CB-779A7B93A7BB', '55C48A42-B800-4A55-8134-309CC9954D4C' )");

        }
        
        public override void Down()
        {
        }
    }
}
